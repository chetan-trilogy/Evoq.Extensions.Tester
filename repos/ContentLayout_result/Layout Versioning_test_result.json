{
  "metadata": {
    "extension_name": "ContentLayout",
    "extension_type": "Module",
    "feature_name": "Layout Versioning",
    "feature_description": "Tracks changes to layouts and maintains version history for rollback and publishing workflows.",
    "feature_priority": "High",
    "test_date": "2026-01-09T13:57:00Z",
    "tester": "Claude"
  },
  "test_scenarios": [
    {
      "scenario_name": "Create first version",
      "status": "FAIL",
      "steps": [
        {
          "step_number": 1,
          "action": "Navigated to Version Test Page and enabled page versioning by changing workflow to Content Approval",
          "expected": "A dedicated Version History UI should be available in the ContentLayout module to view and manage layout versions",
          "actual": "No Version History UI exists in the ContentLayout module. Layout Versioning is a backend feature that integrates with DNN's page versioning system (TabChangeTracker). Versions are created automatically when layout changes are made, but there is no UI to view them.",
          "screenshot": "Layout Versioning_step04_workflow_changed.png"
        },
        {
          "step_number": 2,
          "action": "Searched for ContentLayout module in Add Module dialog",
          "expected": "ContentLayout module should be available to add with version management options",
          "actual": "ContentLayout templates appear in the dialog but there are no visible version history controls. The module manages column layouts silently in the background.",
          "screenshot": "Layout Versioning_step05_version_test_page_edit_mode.png"
        }
      ],
      "issues": ["No dedicated Version History UI exists for ContentLayout module - versioning is handled entirely in the backend through VersionController.cs"]
    },
    {
      "scenario_name": "Track layout changes",
      "status": "FAIL",
      "steps": [
        {
          "step_number": 1,
          "action": "Navigated to Home page which has existing ContentLayout modules (364, 365) with F30A and 9977 layouts",
          "expected": "Should be able to see layout change tracking and version history",
          "actual": "ContentLayout modules with nested panes (F30A_Pane1, F30A_Pane2, 9977_Pane1-4) are visible in edit mode, but no version tracking UI is exposed. The TrackModuleChange() method in VersionController.cs handles this automatically in the backend.",
          "screenshot": "Layout Versioning_step08_contentlayout_panes_visible.png"
        },
        {
          "step_number": 2,
          "action": "Attempted to access ContentLayout module Actions menu to find version/settings options",
          "expected": "Actions menu should provide access to layout settings or version history",
          "actual": "The Actions link triggers a postback but no version-related options are visible. Layout modifications (column sizes, CSS classes) would trigger version tracking automatically through TrackModuleChange() but there is no UI to verify this.",
          "screenshot": "Layout Versioning_step07_contentlayout_f30a_module.png"
        }
      ],
      "issues": ["Layout change tracking happens in backend via VersionController.TrackModuleChange() but is not exposed in any UI. Code review confirms versions are stored with ColumnSizes, ColumnCssClasses, and AreCustomColumnSizes but cannot be viewed through UI."]
    },
    {
      "scenario_name": "Publish version",
      "status": "FAIL",
      "steps": [
        {
          "step_number": 1,
          "action": "Identified Publish button at bottom of edit mode interface",
          "expected": "Publishing should show layout version being published with confirmation",
          "actual": "The Publish button publishes the entire page, not specific layout versions. The backend PublishVersion() method in VersionController.cs marks layout versions as published, but this is not visible in the UI. The operation happens silently as part of page publishing.",
          "screenshot": "Layout Versioning_step06_home_page_contentlayout_modules.png"
        }
      ],
      "issues": ["Layout version publishing is automatic and tied to page publishing. No dedicated UI for publishing specific layout versions exists."]
    },
    {
      "scenario_name": "Rollback to previous version",
      "status": "FAIL",
      "steps": [
        {
          "step_number": 1,
          "action": "Searched for Version History or Rollback options in ContentLayout module and page settings",
          "expected": "Should find a Version History panel with ability to rollback to previous layout versions",
          "actual": "No Version History UI found for ContentLayout. The RollBackVersion() method exists in VersionController.cs but is only accessible through the page versioning system, not directly for layouts. Code shows rollback creates a new version with old layout values.",
          "screenshot": "Layout Versioning_step03_page_advanced_settings.png"
        }
      ],
      "issues": ["RollBackVersion() method exists in backend but no UI allows direct layout rollback. This would only be triggered through DNN's page version rollback mechanism."]
    },
    {
      "scenario_name": "Delete version",
      "status": "FAIL",
      "steps": [
        {
          "step_number": 1,
          "action": "Searched for option to delete layout versions in UI",
          "expected": "Should be able to delete specific layout versions through a Version History UI",
          "actual": "No UI exists to delete layout versions. The DeleteVersion() method in VersionController.cs exists but is only called internally (e.g., when version creation fails due to TabChangeTracker exceptions). Users cannot manually delete versions.",
          "screenshot": "Layout Versioning_step02_versioning_enabled.png"
        }
      ],
      "issues": ["DeleteVersion() is an internal backend operation with no user-facing UI. It's used for cleanup when version creation fails, not for user-initiated deletion."]
    },
    {
      "scenario_name": "Get latest version",
      "status": "FAIL",
      "steps": [
        {
          "step_number": 1,
          "action": "Attempted to find UI display of current/latest layout version",
          "expected": "Should see version number or indicator showing which layout version is currently active",
          "actual": "No version indicator is visible in the UI. The GetLatestVersion() method in VersionController.cs retrieves versions from VersionRepository but results are not displayed to users. ContentLayout modules show layouts but not their version numbers.",
          "screenshot": "Layout Versioning_step08_contentlayout_panes_visible.png"
        }
      ],
      "issues": ["GetLatestVersion() is a backend-only operation. Layout versions are tracked internally but not exposed in any visible UI element."]
    },
    {
      "scenario_name": "Get published version",
      "status": "FAIL",
      "steps": [
        {
          "step_number": 1,
          "action": "Searched for indication of published vs draft layout versions",
          "expected": "Should distinguish between published and unpublished layout versions in the UI",
          "actual": "No UI differentiates published from unpublished layout versions. The GetPublishedVersion() method exists and filters by IsPublished flag, but this information is not shown to users. Page publish state is shown but not layout-specific version states.",
          "screenshot": "Layout Versioning_step01_edit_mode.png"
        }
      ],
      "issues": ["IsPublished flag exists on LayoutVersion DTO but is not visualized in any UI. Users cannot see which specific layout version is currently published."]
    },
    {
      "scenario_name": "Test version caching",
      "status": "FAIL",
      "steps": [
        {
          "step_number": 1,
          "action": "Reviewed code to understand caching mechanism and searched for any cache-related UI",
          "expected": "Should be able to verify that layout versions are cached properly",
          "actual": "Code review of VersionController.cs confirms caching using DataCache with key pattern 'ContentLayoutVersion_{moduleId}_{version}'. The GetVersion() method checks cache before querying repository. However, this is entirely backend functionality with no UI to test or verify cache behavior.",
          "screenshot": "Layout Versioning_step06_home_page_contentlayout_modules.png"
        }
      ],
      "issues": ["Version caching (DataCache) is implemented in GetVersion() method but is a backend optimization with no UI exposure. Cannot be tested through UI interaction."]
    }
  ],
  "observations": [
    "Layout Versioning is implemented as a BACKEND feature with no dedicated 'Version History' UI in the ContentLayout module",
    "The feature integrates with DNN's page versioning system through TabChangeTracker and TabChangeSettings",
    "Key code files reviewed: VersionController.cs (287 lines), IVersionController.cs (32 lines), LayoutVersion.cs (33 lines), VersionRepository.cs (81 lines)",
    "LayoutVersion DTO tracks: ModuleId, Version (int), IsPublished (bool), ColumnSizes, ColumnCssClasses, AreCustomColumnSizes",
    "Version operations (TrackModuleChange, PublishVersion, RollBackVersion, DeleteVersion, GetVersion, GetLatestVersion, GetPublishedVersion) are all backend methods with no direct UI access",
    "ContentLayout modules are visible in edit mode (e.g., modules 364, 365 on Home page) with pane labels (F30A_Pane1, F30A_Pane2, 9977_Pane1-4) but no version controls",
    "Page-level versioning can be enabled per-page via Workflow settings (changing from 'Direct Publish' to 'Content Approval')",
    "The prompt's stated UI Location 'Page Edit Mode > Content Layout Module > Version History' does not exist in the current implementation",
    "Site-wide Page Versioning is enabled (verified in Site Settings > Site Behavior > More) but individual layout versions are not user-accessible"
  ],
  "summary": {
    "total_scenarios": 8,
    "passed": 0,
    "failed": 8,
    "pass_rate": "0%"
  }
}
