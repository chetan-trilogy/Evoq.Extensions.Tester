{
  "metadata": {
    "extension_name": "Evoq.Social.Wiki",
    "extension_type": "Module",
    "feature_name": "Article Deletion",
    "feature_description": "Delete wiki articles with proper cleanup of related data",
    "feature_priority": "High",
    "test_date": "2026-01-09T12:00:00Z",
    "tester": "Claude"
  },
  "test_scenarios": [
    {
      "scenario_name": "Delete confirmation dialog",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Navigate to Wiki module and open an article",
          "expected": "Article view page opens with Delete button visible",
          "actual": "Article 'User Mentions Feature Test' opened with Delete button visible for authorized user",
          "screenshot": "Article_Deletion_step02_article_view_with_delete.png"
        },
        {
          "step_number": 2,
          "action": "Click Delete button",
          "expected": "Confirmation dialog appears asking to confirm deletion",
          "actual": "Dialog appeared with 'Delete this article?' title and 'Are you sure to delete this article?' message with Yes/No buttons",
          "screenshot": "Article_Deletion_step03_delete_confirmation_dialog.png"
        },
        {
          "step_number": 3,
          "action": "Click No to cancel deletion",
          "expected": "Dialog closes without deleting article",
          "actual": "Dialog closed and article remained intact",
          "screenshot": "Article_Deletion_step03_delete_confirmation_dialog.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Delete published article",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Navigate to a published article with comments",
          "expected": "Published article view opens",
          "actual": "Article 'Published Article Test - Jan 2026' opened showing 3 comments",
          "screenshot": "Article_Deletion_step04_published_article_before_delete.png"
        },
        {
          "step_number": 2,
          "action": "Click Delete button and confirm with Yes",
          "expected": "Article is deleted and user is redirected to Wiki list",
          "actual": "Confirmation dialog appeared, clicked Yes, article was deleted and redirected to Wiki list",
          "screenshot": "Article_Deletion_step05_delete_published_confirmation.png"
        },
        {
          "step_number": 3,
          "action": "Verify article is deleted",
          "expected": "Article count decreases and article no longer appears in list",
          "actual": "Article count decreased from 27 to 26, article 'Published Article Test - Jan 2026' no longer in list",
          "screenshot": "Article_Deletion_step06_deletion_successful.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Delete draft article",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Create a new draft article (unapproved)",
          "expected": "Draft article is created with 'awaiting moderation' status",
          "actual": "Created 'Draft Article For Deletion Test' with unchecked Approved checkbox, article showed 'This wiki article is currently awaiting moderation' banner",
          "screenshot": "Article_Deletion_step07_draft_article_created.png"
        },
        {
          "step_number": 2,
          "action": "Click Delete button on draft article",
          "expected": "Confirmation dialog appears",
          "actual": "Confirmation dialog appeared with Yes/No options",
          "screenshot": "Article_Deletion_step08_draft_delete_confirmation.png"
        },
        {
          "step_number": 3,
          "action": "Confirm deletion",
          "expected": "Draft article is deleted",
          "actual": "Draft article was deleted successfully, redirected back to Wiki list",
          "screenshot": "Article_Deletion_step09_draft_deleted_success.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Test delete permissions",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Verify Delete button visibility for authorized user (SuperUser)",
          "expected": "Delete button is visible for users with delete permission",
          "actual": "Delete button was visible on all article views when logged in as SuperUser (host account)",
          "screenshot": "Article_Deletion_step02_article_view_with_delete.png"
        },
        {
          "step_number": 2,
          "action": "Review code for permission checks",
          "expected": "Code should have authorization attributes",
          "actual": "ContentController.cs DeletePage method has [DnnAuthorize] and [ValidateAntiForgeryToken] attributes. NotificationServiceController.cs DeleteArticle also has authorization checks including CurrentUserIsNotificationReceiver validation",
          "screenshot": "Article_Deletion_step02_article_view_with_delete.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Test cascading deletes (comments, likes)",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Delete article with comments",
          "expected": "Article and all related data (comments, notifications, subscriptions, revisions) should be deleted",
          "actual": "Article 'Published Article Test - Jan 2026' which had 3 comments was deleted. Code review of ArticleController.cs Delete method confirms cascading cleanup: removes notifications, revisions, comments, journal entries, and subscriptions",
          "screenshot": "Article_Deletion_step06_deletion_successful.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Delete from notification",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Navigate to notifications page",
          "expected": "Notifications with Delete option are visible",
          "actual": "Notification page showed 'Article Reported: XSS Sanitization Test Article' with Delete | Reject | Dismiss options",
          "screenshot": "Article_Deletion_step10_notifications_with_delete.png"
        },
        {
          "step_number": 2,
          "action": "Click Delete link in notification",
          "expected": "Confirmation dialog appears",
          "actual": "Dialog appeared with message 'Are you sure you wish to delete the Wiki article and all of its revisions?' and Yes/No buttons",
          "screenshot": "Article_Deletion_step11_notification_delete_confirm.png"
        },
        {
          "step_number": 3,
          "action": "Confirm deletion",
          "expected": "Article is deleted and notification is removed",
          "actual": "Success message 'The action has been performed successfully.' displayed, notification count decreased from 4 to 3",
          "screenshot": "Article_Deletion_step12_notification_delete_success.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Restore deleted article",
      "status": "FAIL",
      "steps": [
        {
          "step_number": 1,
          "action": "Search for restore functionality in UI and code",
          "expected": "Restore option or functionality should exist",
          "actual": "No restore functionality found in UI or code. Code review of ArticleController.cs Delete method shows permanent deletion with no soft-delete or restore mechanism implemented",
          "screenshot": "Article_Deletion_step06_deletion_successful.png"
        }
      ],
      "issues": ["Restore functionality does not exist - deletion is permanent with no recovery option"]
    }
  ],
  "observations": [
    "Deletion is permanent - the ArticleController.cs Delete method performs hard deletes on all related data including revisions, comments, notifications, journal entries, and subscriptions with no soft-delete or restore mechanism",
    "Delete confirmation dialog consistently shows 'Delete this article?' with 'Are you sure to delete this article?' message and Yes/No buttons",
    "When deleting from notification, an additional confirmation is shown mentioning 'all of its revisions' will be deleted",
    "Cascading deletes properly clean up: notifications (RemoveAllNotifications), revisions (DeleteRevisionsByContentItemId), comments (GetAllComments then OnDeletedComment events), journal entries (RemoveWikiFromJournal), and subscriptions (RemoveContentSubscriptions)",
    "Delete button is only visible to authorized users - code uses [DnnAuthorize] attribute and additional permission checks",
    "Points are adjusted when articles are deleted - observed points decrease from 195 to 190 after deleting draft article",
    "Code suggests no 'Restore deleted article' feature exists - this is a functional limitation, not a bug"
  ],
  "summary": {
    "total_scenarios": 7,
    "passed": 6,
    "failed": 1,
    "pass_rate": "86%"
  }
}
