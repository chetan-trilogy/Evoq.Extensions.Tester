{
  "metadata": {
    "extension_name": "Evoq.Social.Wiki",
    "extension_type": "Module",
    "feature_name": "User Mentions",
    "feature_description": "Mention users in articles and comments with @ notation and notifications",
    "feature_priority": "Medium",
    "test_date": "2026-01-09T12:00:00Z",
    "tester": "Claude"
  },
  "test_scenarios": [
    {
      "scenario_name": "Mention user in article",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Navigate to Wiki module and click Create article",
          "expected": "Create article dialog should open",
          "actual": "Create article dialog opened successfully",
          "screenshot": "User_Mentions_step02_create_dialog.png"
        },
        {
          "step_number": 2,
          "action": "Type article content with @Test to trigger mention autocomplete",
          "expected": "Autocomplete dropdown should appear with matching users",
          "actual": "Autocomplete dropdown appeared showing users: Claude TestUser, NoActivity TestUser, Regular TestUser, Test Admin, Test Editor",
          "screenshot": "User_Mentions_step04_autocomplete_dropdown.png"
        },
        {
          "step_number": 3,
          "action": "Select Test Admin from autocomplete dropdown",
          "expected": "User name should be inserted as a mention link",
          "actual": "Test Admin was inserted as a turquoise clickable link in the editor",
          "screenshot": "User_Mentions_step05_user_selected.png"
        },
        {
          "step_number": 4,
          "action": "Publish the article",
          "expected": "Article should be published with mention converted to profile link",
          "actual": "Article published successfully. Test Admin appears as clickable profile link (href to /Activity-Feed/userId/4)",
          "screenshot": "User_Mentions_step06_article_published.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Mention user in comment",
      "status": "FAIL",
      "steps": [
        {
          "step_number": 1,
          "action": "Click Add a Comment on an article",
          "expected": "Comment input area should appear",
          "actual": "Comment input area appeared",
          "screenshot": "User_Mentions_step07_comment_box.png"
        },
        {
          "step_number": 2,
          "action": "Type @Test in comment field to trigger mention autocomplete",
          "expected": "Autocomplete dropdown should appear with matching users",
          "actual": "NO autocomplete appeared. Console showed 'active element is not valid' errors. The comment editor does not have the mentions plugin initialized.",
          "screenshot": "User_Mentions_step11_comment_mention_attempt.png"
        },
        {
          "step_number": 3,
          "action": "Submit comment with @Test mention",
          "expected": "Mention should be converted to profile link",
          "actual": "@Test remained as plain text in the posted comment, not converted to a link",
          "screenshot": "User_Mentions_step12_comment_posted.png"
        }
      ],
      "issues": [
        "User mentions autocomplete does NOT work in comments - only in article editor",
        "@mentions in comments appear as plain text, not clickable profile links",
        "Console shows 'active element is not valid' errors when typing in comment field"
      ]
    },
    {
      "scenario_name": "Test mention auto-complete",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "In article editor, type @ followed by search term",
          "expected": "Autocomplete dropdown should appear with matching users",
          "actual": "Autocomplete dropdown appeared showing all users matching the search term",
          "screenshot": "User_Mentions_step04_autocomplete_dropdown.png"
        },
        {
          "step_number": 2,
          "action": "Verify autocomplete shows user avatars and names",
          "expected": "Each autocomplete item should show user avatar and display name",
          "actual": "Each item showed user avatar image and display name (e.g., Test Admin, Claude TestUser)",
          "screenshot": "User_Mentions_step04_autocomplete_dropdown.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Test multiple mentions",
      "status": "FAIL",
      "steps": [
        {
          "step_number": 1,
          "action": "Create new article and add first mention @Test",
          "expected": "Autocomplete should appear and allow selection",
          "actual": "Autocomplete appeared, Test Admin selected successfully",
          "screenshot": "User_Mentions_step14_multiple_mentions_editor.png"
        },
        {
          "step_number": 2,
          "action": "Add second mention @Claude in same article",
          "expected": "Second autocomplete should appear and allow selection",
          "actual": "Second autocomplete appeared, Claude TestUser selected successfully. Both mentions shown as links in editor.",
          "screenshot": "User_Mentions_step15_two_mentions_selected.png"
        },
        {
          "step_number": 3,
          "action": "Publish article with multiple mentions",
          "expected": "Article should publish with both mentions as profile links",
          "actual": "PUBLISHING FAILED with HTTP 406 (Not Acceptable) error. Error message: 'Unable to publish the changes to your article: An error has occurred.'",
          "screenshot": "User_Mentions_step16_multiple_mentions_error.png"
        }
      ],
      "issues": [
        "Articles with multiple user mentions cannot be published",
        "Server returns HTTP 406 error when attempting to save article with more than one mention",
        "This is a critical bug - multiple mentions work in editor but fail at save time"
      ]
    },
    {
      "scenario_name": "Test invalid user mentions",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Type @Claude (non-existent user) in comment without selecting from autocomplete",
          "expected": "Text should remain as plain text since no user was selected",
          "actual": "@Claude remained as plain text in the posted comment, as expected for invalid/unselected mentions",
          "screenshot": "User_Mentions_step12_comment_posted.png"
        },
        {
          "step_number": 2,
          "action": "Verify that only mentions selected from autocomplete become links",
          "expected": "Only autocomplete-selected mentions should become profile links",
          "actual": "Confirmed - Test Admin (selected from autocomplete) became a link, @Claude (typed without selection) remained plain text",
          "screenshot": "User_Mentions_step12_comment_posted.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Test mention notification delivery",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Review code for notification functionality",
          "expected": "Code should call notification methods when mentions are processed",
          "actual": "Code review confirmed: UserMentionNotificationsController.Instance.SendUserMentionedNotification() is called in ContentController.cs when article is published. UserMentionNotificationsController.Instance.SendUserMentionedInCommentNotification() is called in SocialController.cs when comment is posted.",
          "screenshot": "User_Mentions_step06_article_published.png"
        }
      ],
      "issues": [
        "Notification delivery cannot be fully verified via UI testing - requires checking recipient's notification inbox"
      ]
    }
  ],
  "observations": [
    "User mentions autocomplete only works in the article editor (Redactor), not in comment fields",
    "The mentions JavaScript plugin (dnn.social.mentions.js) is not initialized for comment text areas",
    "Publishing articles with multiple mentions fails with HTTP 406 error - appears to be a server-side bug",
    "Mentions in comments always appear as plain text regardless of @ notation used",
    "The UserMentionsController uses token format [UM_ID:{userId}] internally to store mentions",
    "Mention links are rendered with class 'evoq-mention-link' and data-mention attribute containing user ID",
    "Edit mode for existing articles also does not trigger autocomplete for new mentions"
  ],
  "summary": {
    "total_scenarios": 6,
    "passed": 4,
    "failed": 2,
    "pass_rate": "67%"
  }
}
