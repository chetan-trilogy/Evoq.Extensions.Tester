{
  "metadata": {
    "extension_name": "Evoq.GoogleTagManagerConnector",
    "extension_type": "Connector",
    "feature_name": "Google Analytics Integration",
    "feature_description": "Option to use Google Tag Manager for Google Analytics tracking instead of native GA implementation",
    "feature_priority": "High",
    "test_date": "2026-01-09T15:28:00Z",
    "tester": "Claude"
  },
  "test_scenarios": [
    {
      "scenario_name": "Enable GA through GTM checkbox",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Navigate to Admin > Settings > Connectors > Google Tag Manager",
          "expected": "GTM connector settings panel should open",
          "actual": "GTM connector panel opened showing Container ID field and GA checkbox",
          "screenshot": "GA_Integration_step01_initial_state.png"
        },
        {
          "step_number": 2,
          "action": "Enter Container ID (GTM-P7RJMM) and click the GA checkbox toggle to enable",
          "expected": "Checkbox should toggle from Off to On",
          "actual": "Checkbox successfully toggled to On state",
          "screenshot": "GA_Integration_step02_enable_checkbox.png"
        },
        {
          "step_number": 3,
          "action": "Click Save button",
          "expected": "Settings should save successfully",
          "actual": "Success message 'Item successfully saved' displayed",
          "screenshot": "GA_Integration_step03_save_success.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Disable GA through GTM checkbox",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Open GTM connector settings and click the GA checkbox toggle to disable",
          "expected": "Checkbox should toggle from On to Off",
          "actual": "Checkbox successfully toggled to Off state",
          "screenshot": "GA_Integration_step07_disable_checkbox.png"
        },
        {
          "step_number": 2,
          "action": "Click Save button",
          "expected": "Settings should save successfully",
          "actual": "Settings saved successfully",
          "screenshot": "GA_Integration_step08_dataLayer_disabled.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Verify eaSendGaEvents flag in dataLayer when enabled",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Configure GTM with Container ID and enable GA checkbox, save, then navigate to a page",
          "expected": "GTM script should be injected with eaSendGaEvents: true in dataLayer",
          "actual": "dataLayer contains {\"eaSendGaEvents\": true, \"pageVariant\": \"Default\"} confirming the flag is set correctly",
          "screenshot": "GA_Integration_step06_dataLayer_enabled.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Verify flag is false when disabled",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Disable GA checkbox, save, then navigate to a page and check dataLayer",
          "expected": "GTM script should be injected with eaSendGaEvents: false in dataLayer",
          "actual": "dataLayer contains {\"eaSendGaEvents\": false, \"pageVariant\": \"Default\"} confirming the flag is set to false when checkbox is disabled",
          "screenshot": "GA_Integration_step08_dataLayer_disabled.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Test automatic disable when container ID is cleared",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Enable the GA checkbox with a valid Container ID",
          "expected": "Checkbox should be enabled",
          "actual": "Checkbox enabled and showing On state",
          "screenshot": "GA_Integration_step09_before_clear_container.png"
        },
        {
          "step_number": 2,
          "action": "Clear the Container ID field",
          "expected": "Container ID field should be empty",
          "actual": "Container ID field cleared successfully",
          "screenshot": "GA_Integration_step10_container_cleared.png"
        },
        {
          "step_number": 3,
          "action": "Click Save and verify checkbox state",
          "expected": "GA checkbox should be automatically disabled when Container ID is empty",
          "actual": "After saving with empty Container ID, the connector reverted to 'Connect' state and shows 'Off' status, confirming automatic disable functionality",
          "screenshot": "GA_Integration_step11_auto_disabled.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Verify checkbox state persists after save",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Enable checkbox and save, then navigate away and return to settings",
          "expected": "Checkbox state should persist as enabled",
          "actual": "After saving with checkbox enabled, navigating to other pages and returning to connector settings showed checkbox state persisted correctly. Both enabled (On) and disabled (Off) states persisted correctly after page refresh",
          "screenshot": "GA_Integration_step05_save_success.png"
        }
      ],
      "issues": []
    }
  ],
  "observations": [
    "The GTM script injects 'eaSendGaEvents' flag directly into the dataLayer based on the checkbox setting",
    "The automatic disable feature correctly sets UseTagManagerForGA to False when Container ID is cleared, as implemented in GoogleTagManagerConnector.cs lines 87-89",
    "Container ID validation occurs via HTTP request to googletagmanager.com before saving",
    "The connector shows 'Edit' button when configured (with Container ID) and 'Connect' button when not configured"
  ],
  "summary": {
    "total_scenarios": 6,
    "passed": 6,
    "failed": 0,
    "pass_rate": "100%"
  }
}
