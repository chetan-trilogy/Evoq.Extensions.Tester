{
  "metadata": {
    "extension_name": "Evoq.GoogleTagManagerConnector",
    "extension_type": "Connector",
    "feature_name": "GTM Container Configuration",
    "feature_description": "Configure Google Tag Manager container ID and settings for a portal including validation against Google servers",
    "feature_priority": "Top",
    "test_date": "2026-01-09T14:30:00Z",
    "tester": "Claude"
  },
  "test_scenarios": [
    {
      "scenario_name": "Save valid GTM container ID",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Navigate to Admin > Settings > Connectors > Google Tag Manager",
          "expected": "GTM connector edit panel opens",
          "actual": "GTM connector edit panel opened successfully showing Container ID field and Use Tag Manager for GA checkbox",
          "screenshot": "GTM_Container_Configuration_step01_edit_panel_open.png"
        },
        {
          "step_number": 2,
          "action": "Enter valid GTM container ID 'GTM-P7RJMM' and click Save",
          "expected": "Container ID is validated against Google servers and saved successfully",
          "actual": "Success message 'Item successfully saved.' displayed. Container ID validated and saved.",
          "screenshot": "GTM_Container_Configuration_step02_save_valid_id_success.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Save empty container ID to disable GTM",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Clear the Container ID field to empty",
          "expected": "Field is cleared",
          "actual": "Container ID field cleared successfully",
          "screenshot": "GTM_Container_Configuration_step03_empty_container_id.png"
        },
        {
          "step_number": 2,
          "action": "Click Save with empty Container ID",
          "expected": "Empty value is accepted to disable GTM",
          "actual": "Success message 'Item successfully saved.' displayed. GTM connector shows 'Connect' button indicating disconnected state.",
          "screenshot": "GTM_Container_Configuration_step04_empty_save_success.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Attempt to save invalid container ID format",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Enter invalid format 'INVALID-FORMAT' in Container ID field",
          "expected": "Invalid format is rejected",
          "actual": "Invalid format 'INVALID-FORMAT' entered in the field",
          "screenshot": "GTM_Container_Configuration_step05_invalid_format_entered.png"
        },
        {
          "step_number": 2,
          "action": "Click Save",
          "expected": "Error message displayed for invalid format",
          "actual": "Error message 'The given Container Id is not valid' displayed. Invalid format correctly rejected by server-side validation against Google servers.",
          "screenshot": "GTM_Container_Configuration_step06_invalid_format_error.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Attempt to save non-existent container ID",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Enter non-existent GTM ID 'GTM-ZZZZZZZ' in Container ID field",
          "expected": "Non-existent ID is rejected after validation against Google servers",
          "actual": "Non-existent GTM ID 'GTM-ZZZZZZZ' entered in the field",
          "screenshot": "GTM_Container_Configuration_step07_nonexistent_id_entered.png"
        },
        {
          "step_number": 2,
          "action": "Click Save",
          "expected": "Error message displayed for non-existent container",
          "actual": "Error message 'The given Container Id is not valid' displayed. Non-existent container ID correctly rejected after server-side validation against Google's GTM service.",
          "screenshot": "GTM_Container_Configuration_step08_nonexistent_id_error.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Verify settings persist after save",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Enter valid GTM ID 'GTM-P7RJMM' and save",
          "expected": "Settings saved successfully",
          "actual": "Settings saved with success message",
          "screenshot": "GTM_Container_Configuration_step09_persistence_saved.png"
        },
        {
          "step_number": 2,
          "action": "Close the edit panel and reopen it",
          "expected": "Previously saved Container ID is still displayed",
          "actual": "Container ID 'GTM-P7RJMM' persisted and displayed after reopening the edit panel. Green checkmark visible next to connector indicating connected state.",
          "screenshot": "GTM_Container_Configuration_step10_persistence_verified.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "XSS injection attempt rejection",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Enter XSS payload '<script>alert(1)</script>' in Container ID field",
          "expected": "XSS payload is rejected",
          "actual": "XSS payload entered in the field",
          "screenshot": "GTM_Container_Configuration_step11_xss_attempt.png"
        },
        {
          "step_number": 2,
          "action": "Click Save",
          "expected": "Error message displayed, XSS payload not accepted",
          "actual": "Error message 'The given Container Id is not valid' displayed. XSS injection attempt correctly rejected by server-side validation.",
          "screenshot": "GTM_Container_Configuration_step12_xss_rejected.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Use Tag Manager for Google Analytics checkbox toggle",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "With valid Container ID configured, toggle 'Use Tag Manager for Google Analytics' checkbox from Off to On",
          "expected": "Checkbox toggles to On state",
          "actual": "Checkbox successfully toggled to 'On' state with blue toggle indicator",
          "screenshot": "GTM_Container_Configuration_step13_checkbox_toggle_on.png"
        },
        {
          "step_number": 2,
          "action": "Click Save to persist checkbox setting",
          "expected": "Setting saved successfully",
          "actual": "Success message displayed. Checkbox setting persisted with Container ID. Green checkmark visible next to Google Tag Manager connector.",
          "screenshot": "GTM_Container_Configuration_step14_checkbox_save_success.png"
        }
      ],
      "issues": []
    }
  ],
  "observations": [
    "Container ID validation is performed server-side against Google's GTM service (https://www.googletagmanager.com/gtm.js?id={containerId})",
    "The connector validates by making an HTTP GET request to Google and checking for HTTP 200 response",
    "Invalid, non-existent, and malformed container IDs are all properly rejected with the same error message: 'The given Container Id is not valid'",
    "When Container ID is cleared/empty, the 'Use Tag Manager for GA' setting is automatically set to False (per code in SaveConfig method)",
    "Portal-specific configuration isolation is handled through PortalController.Instance.GetPortalSettings(portalId) and PortalController.UpdatePortalSetting()",
    "The connector supports a 'Use Tag Manager for Google Analytics' checkbox which allows GTM to handle GA script injection",
    "No client-side format validation exists - all validation happens server-side which provides better security but slower feedback"
  ],
  "summary": {
    "total_scenarios": 7,
    "passed": 7,
    "failed": 0,
    "pass_rate": "100%"
  }
}
