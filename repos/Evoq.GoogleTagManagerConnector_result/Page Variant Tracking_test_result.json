{
  "metadata": {
    "extension_name": "Evoq.GoogleTagManagerConnector",
    "extension_type": "Connector",
    "feature_name": "Page Variant Tracking",
    "feature_description": "Tracks personalized page variants in GTM dataLayer for A/B testing and personalization analytics",
    "feature_priority": "Medium",
    "test_date": "2026-01-09T12:30:00Z",
    "tester": "Claude"
  },
  "test_scenarios": [
    {
      "scenario_name": "Verify default page variant 'Default' in dataLayer",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Logged in as SuperUser and navigated to home page",
          "expected": "Page loads with GTM dataLayer initialized",
          "actual": "Home page loaded successfully with GTM active (shown by Edit button in Connectors panel)",
          "screenshot": "Page_Variant_Tracking_setup_login.png"
        },
        {
          "step_number": 2,
          "action": "Executed JavaScript to check dataLayer variable",
          "expected": "dataLayer should contain pageVariant property with value 'Default'",
          "actual": "dataLayer[0] contained {\"eaSendGaEvents\": false, \"pageVariant\": \"Default\"} - confirming default page variant is correctly set",
          "screenshot": "Page_Variant_Tracking_step01_default_variant.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Verify pageVariant appears in GTM dataLayer initialization",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Checked dataLayer array structure via browser JavaScript evaluation",
          "expected": "pageVariant should be in the first dataLayer entry (initialization)",
          "actual": "pageVariant was present in dataLayer[0] alongside eaSendGaEvents, confirming it is injected during GTM initialization as per TagManagerModule.cs RenderCustomGtmScript() method",
          "screenshot": "Page_Variant_Tracking_step01_default_variant.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Test variant tracking without personalization",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Verified page variant value when no content personalization is active",
          "expected": "pageVariant should be 'Default' when personalization is not enabled",
          "actual": "pageVariant value was 'Default' as expected - code in TagManagerModule.cs line 92-93 confirms default is 'Default' when ContentPersonalizedPageVariantName is not set in HttpContext.Items",
          "screenshot": "Page_Variant_Tracking_step01_default_variant.png"
        }
      ],
      "issues": []
    }
  ],
  "observations": [
    "GTM connector state appeared to change during testing session - initially showed as configured (Edit button with green checkmark) but later showed as not configured (Connect button). This may be a portal caching issue or session-related behavior.",
    "Custom page variant names require Content Personalization to be enabled and configured, which sets the 'evoq_PersonalizedPageVariantName' key in HttpContext.Items. Testing custom variant names would require setting up personalization rules.",
    "The pageVariant tracking is implemented as part of the GTM dataLayer initialization script injection, not as a separate configurable feature in the UI.",
    "Code analysis confirms pageVariant is always present in dataLayer when GTM is active - it defaults to 'Default' and would show the personalized variant name when Content Personalization sets a custom variant."
  ],
  "summary": {
    "total_scenarios": 3,
    "passed": 3,
    "failed": 0,
    "pass_rate": "100%"
  }
}
