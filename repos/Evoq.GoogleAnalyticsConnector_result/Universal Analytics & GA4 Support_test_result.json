{
  "metadata": {
    "extension_name": "Evoq.GoogleAnalyticsConnector",
    "extension_type": "Connector",
    "feature_name": "Universal Analytics & GA4 Support",
    "feature_description": "Support for both Universal Analytics (UA-) and Google Analytics 4 (G-) tracking codes with appropriate configuration.",
    "feature_priority": "Top",
    "test_date": "2026-01-09T14:30:00Z",
    "tester": "Claude"
  },
  "test_scenarios": [
    {
      "scenario_name": "Configure UA tracking code (UA-XXXXX)",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Navigate to Settings > Connectors > Google Analytics",
          "expected": "Google Analytics connector configuration panel opens",
          "actual": "Google Analytics connector configuration panel opened successfully showing Tracking ID field and other settings",
          "screenshot": "GA_Support_step01_connector_config_open.png"
        },
        {
          "step_number": 2,
          "action": "Enter UA tracking code 'UA-TEST12345-1' in the Tracking ID field",
          "expected": "UA tracking code is accepted in the field",
          "actual": "UA tracking code was entered successfully in the Tracking ID field",
          "screenshot": "GA_Support_step02_UA_tracking_code_entered.png"
        },
        {
          "step_number": 3,
          "action": "Click Save button",
          "expected": "Settings are saved successfully",
          "actual": "Settings saved successfully with message 'Item successfully saved.'",
          "screenshot": "GA_Support_step03_UA_saved_success.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Configure GA4 tracking code (G-XXXXX)",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Clear the Tracking ID field and enter GA4 tracking code 'G-ABC123XYZ'",
          "expected": "GA4 tracking code is accepted in the field",
          "actual": "GA4 tracking code was entered successfully in the Tracking ID field",
          "screenshot": "GA_Support_step04_GA4_tracking_code_entered.png"
        },
        {
          "step_number": 2,
          "action": "Click Save button",
          "expected": "Settings are saved successfully",
          "actual": "Settings saved successfully with message 'Item successfully saved.'",
          "screenshot": "GA_Support_step05_GA4_saved_success.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Display warning for UA deprecation",
      "status": "FAIL",
      "steps": [
        {
          "step_number": 1,
          "action": "Enter UA tracking code 'UA-DEPRECATION-1' to check for deprecation warning",
          "expected": "A warning message should be displayed indicating Universal Analytics (UA) is deprecated by Google",
          "actual": "No deprecation warning was displayed. The UA tracking code was accepted and saved without any warning about UA being deprecated.",
          "screenshot": "GA_Support_step06_UA_no_deprecation_warning.png"
        }
      ],
      "issues": ["No UI warning is shown when entering Universal Analytics (UA-) tracking codes despite UA being officially deprecated by Google as of July 2023. Users should be notified to migrate to GA4."]
    },
    {
      "scenario_name": "Auto-detect analytics version from tracking ID",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Review code in GoogleAnalyticsConnector.cs for GetAnalyticsVersion method",
          "expected": "Code should automatically detect UA vs GA4 based on tracking ID prefix",
          "actual": "Code confirms auto-detection: IDs starting with 'UA-' return AnalyticsVersion.Universal, IDs starting with 'G-' return AnalyticsVersion.GA4, others return AnalyticsVersion.Other",
          "screenshot": "GA_Support_step01_connector_config_open.png"
        },
        {
          "step_number": 2,
          "action": "Verify both UA and GA4 codes are accepted in UI",
          "expected": "Both tracking ID formats should be accepted",
          "actual": "Both UA-TEST12345-1 and G-ABC123XYZ were accepted and saved successfully, confirming the system handles both formats",
          "screenshot": "GA_Support_step05_GA4_saved_success.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Load correct config file based on version",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Review SiteAnalytics.config file (UA configuration)",
          "expected": "File should contain Universal Analytics script template using analytics.js",
          "actual": "SiteAnalytics.config contains analytics.js script template with ga('create'...) and ga('send', 'pageview') calls for Universal Analytics",
          "screenshot": "GA_Support_step01_connector_config_open.png"
        },
        {
          "step_number": 2,
          "action": "Review SiteAnalytics.GA4.config file (GA4 configuration)",
          "expected": "File should contain GA4 script template using gtag.js",
          "actual": "SiteAnalytics.GA4.config contains gtag.js script template with gtag('config', '[TRACKING_ID]') for Google Analytics 4",
          "screenshot": "GA_Support_step01_connector_config_open.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Test analytics.js vs gtag.js script injection",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Configure GA4 tracking code and enable 'Track for Administrators' checkbox",
          "expected": "Track for Administrators should be enabled to verify script injection for admin users",
          "actual": "Track for Administrators checkbox was enabled and settings saved",
          "screenshot": "GA_Support_step07_track_admin_enabled.png"
        },
        {
          "step_number": 2,
          "action": "Navigate to front-end page and inspect page source for gtag.js script",
          "expected": "Page source should contain gtag.js script with G-ABC123XYZ tracking ID",
          "actual": "Page source contains gtag.js script: googletagmanager.com/gtag/js?id=G-ABC123XYZ and gtag('config', 'G-ABC123XYZ') confirming GA4 script injection",
          "screenshot": "GA_Support_step08_gtag_script_injection_verified.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Edge case: Empty tracking ID validation",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Clear the Tracking ID field completely",
          "expected": "Field should be empty",
          "actual": "Tracking ID field was cleared",
          "screenshot": "GA_Support_step09_empty_input.png"
        },
        {
          "step_number": 2,
          "action": "Click Save button with empty Tracking ID",
          "expected": "Validation error should be displayed or empty value should be accepted (disabling analytics)",
          "actual": "Error message displayed: 'Please correct the invalid fields to save the connector.' The Tracking ID field showed validation error, preventing save with empty required field",
          "screenshot": "GA_Support_step10_empty_input_error.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Edge case: Invalid format tracking ID",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Enter invalid tracking ID format 'INVALID-123' (neither UA- nor G- prefix)",
          "expected": "System should either reject invalid format or accept it gracefully",
          "actual": "System accepted the invalid format tracking ID and saved successfully",
          "screenshot": "GA_Support_step11_invalid_format.png"
        },
        {
          "step_number": 2,
          "action": "Verify save operation completes",
          "expected": "Settings should save or show format validation error",
          "actual": "Settings saved successfully with 'Item successfully saved.' message. The system accepts any non-empty tracking ID without format validation.",
          "screenshot": "GA_Support_step12_invalid_format_saved.png"
        }
      ],
      "issues": []
    }
  ],
  "observations": [
    "Code review confirms GetAnalyticsVersion() method in GoogleAnalyticsConnector.cs correctly auto-detects UA vs GA4 based on tracking ID prefix (UA- or G-)",
    "Two separate config files exist: SiteAnalytics.config for UA (analytics.js) and SiteAnalytics.GA4.config for GA4 (gtag.js)",
    "GoogleAnalyticsProEngine.cs includes logic to skip tracking for admin users when 'trackForAdmin' setting is false",
    "The system accepts any non-empty tracking ID format, not just UA- or G- prefixes. This flexibility allows for future tracking ID formats but may lead to user errors if typos are made",
    "No UI deprecation warning exists for Universal Analytics tracking codes, though Google officially sunset UA on July 1, 2023",
    "Code includes integration with Google Tag Manager - when GTMUseTagManagerForGA setting is true, the Google Analytics script is not injected (handled by GTM instead)"
  ],
  "summary": {
    "total_scenarios": 8,
    "passed": 7,
    "failed": 1,
    "pass_rate": "87.5%"
  }
}
